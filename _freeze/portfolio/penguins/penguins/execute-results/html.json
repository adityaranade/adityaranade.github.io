{
  "hash": "0943ca4c661fdb77b9f649437aa94d30",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Identify Penguin species\"\nsubtitle: \"Identify penguin species using multinomial Logistic Regression\"\nauthor: \"Aditya Ranade\"\nhighlight-style:\n  light: github\ndate: \"2025-04-29\"\ncategories: [analysis, R]\nimage: \"./penguin.jpg\"\n---\n\n\n\n\n\n::: {style=\"text-align: justify\"}\nI found this [dataset](https://archive.ics.uci.edu/dataset/690/palmer+penguins-3) on UCI machine learning repository which gives the dataset for 3 penguin species in the islands of Palmer Archipelago, Antarctica. It has some basic measurements on the penguins of the 3 species.\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reshape2)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(ggh4x)\nlibrary(GGally)\nlibrary(naivebayes)\nlibrary(caret)\nlibrary(nnet)\n\n# Data is available in the palmer penguins package in R\nlibrary(palmerpenguins)\n\n\n# Data processing\ndata0 <- penguins\nhead(data0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 8\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n1 Adelie  Torgersen           39.1          18.7               181        3750\n2 Adelie  Torgersen           39.5          17.4               186        3800\n3 Adelie  Torgersen           40.3          18                 195        3250\n4 Adelie  Torgersen           NA            NA                  NA          NA\n5 Adelie  Torgersen           36.7          19.3               193        3450\n6 Adelie  Torgersen           39.3          20.6               190        3650\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n\n```{.r .cell-code}\ndata0 |> str()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [344 × 8] (S3: tbl_df/tbl/data.frame)\n $ species          : Factor w/ 3 levels \"Adelie\",\"Chinstrap\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ island           : Factor w/ 3 levels \"Biscoe\",\"Dream\",..: 3 3 3 3 3 3 3 3 3 3 ...\n $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...\n $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...\n $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...\n $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...\n $ sex              : Factor w/ 2 levels \"female\",\"male\": 2 1 1 NA 1 2 1 2 NA NA ...\n $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check the rows which do not have any entries\nsum(is.na(data0)) # 19 NA values\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 19\n```\n\n\n:::\n\n```{.r .cell-code}\n# exclude the rows which has NA in them\ndata00 <- na.omit(data0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pairs plot between the explanatory variables to \n# check correlation between each pair of the variables\nggpairs(data00[,-c(2,8)])\n```\n\n::: {.cell-output-display}\n![](penguins_files/figure-html/EDA0-1.png){width=1344}\n:::\n:::\n\n\n\n\n\n::: {style=\"text-align: justify\"}\nIt is not unexpected to see multicollinearity in the data for the continuous variables since they are body measurements for the penguins.\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Histogram based on species\nmelted_data <- melt(data00[,c(1,3,4,5,6)], id=\"species\")\n\n# Plot the histogram of all the variables\nggplot(melted_data,aes(value))+\n  geom_histogram(aes(),bins = 30)+\n  facet_grid2(species~variable, scales=\"free\")+theme_bw()\n```\n\n::: {.cell-output-display}\n![](penguins_files/figure-html/EDA1-1.png){width=1344}\n:::\n\n```{.r .cell-code}\n# Histogram based on sex\nmelted_data2 <- melt(data00[,c(3,4,5,6,7)], id=\"sex\")\n\n# Plot the histogram of all the variables\nggplot(melted_data2,aes(value))+\n  geom_histogram(aes(),bins = 30)+\n  facet_grid2(sex~variable, scales=\"free\")+theme_bw()\n```\n\n::: {.cell-output-display}\n![](penguins_files/figure-html/EDA1-2.png){width=1344}\n:::\n:::\n\n\n\n\n\n::: {style=\"text-align: justify\"}\nThere is a distinct difference in the histogram of all the variables based on the species and sex. We will look to build a naive Bayes classification model to identify the species of penguins. First let us split the data into training and testing set.\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select variables to be used in the model\ndata <- data00 %>% dplyr::select(species,bill_length_mm,bill_depth_mm,\n                                 flipper_length_mm,body_mass_g)\n\ndata1 <- subset(data, species == \"Adelie\")\ndata2 <- subset(data, species == \"Chinstrap\")\ndata3 <- subset(data, species == \"Gentoo\")\n\n# split the data into training (70%) and testing (30%) data\nseed <- 33\nset.seed(seed)\nind1 <- sample(floor(0.7*nrow(data1)),\n              replace = FALSE)\n\nind2 <- sample(floor(0.7*nrow(data2)),\n               replace = FALSE)\n\nind3 <- sample(floor(0.7*nrow(data3)),\n               replace = FALSE)\n\n\n# Training dataset\ndata_train <- rbind(data1[ind1,],data2[ind2,],data3[ind3,])\ndata_train |> count(species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 2\n  species       n\n  <fct>     <int>\n1 Adelie      102\n2 Chinstrap    47\n3 Gentoo       83\n```\n\n\n:::\n\n```{.r .cell-code}\n# Testing dataset\ndata_test <- rbind(data1[-ind1,],data2[-ind2,],data3[-ind3,])\ndata_test |> count(species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 2\n  species       n\n  <fct>     <int>\n1 Adelie       44\n2 Chinstrap    21\n3 Gentoo       36\n```\n\n\n:::\n:::\n\n\n\n\n\n::: {style=\"text-align: justify\"}\nWe now build a multinomial logistic regression model to identify the species of Penguins. A multinomial logistic regression model is used when we have more than 2 nominal classes in a categorical variables.\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2 <- multinom(species ~ ., data = data_train) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# weights:  18 (10 variable)\ninitial  value 254.878051 \niter  10 value 18.171584\niter  20 value 3.530079\niter  30 value 1.576129\niter  40 value 0.007276\niter  50 value 0.000719\niter  60 value 0.000656\niter  70 value 0.000216\niter  80 value 0.000214\niter  90 value 0.000195\niter 100 value 0.000192\nfinal  value 0.000192 \nstopped after 100 iterations\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel2 |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nmultinom(formula = species ~ ., data = data_train)\n\nCoefficients:\n          (Intercept) bill_length_mm bill_depth_mm flipper_length_mm\nChinstrap   -4.627397       50.77590     -53.80151        -4.4291595\nGentoo      -3.282477       26.93981     -66.79718        -0.9805378\n          body_mass_g\nChinstrap -0.10625251\nGentoo     0.04238281\n\nStd. Errors:\n           (Intercept) bill_length_mm bill_depth_mm flipper_length_mm\nChinstrap 0.0324946625    0.792550472   0.351600282        4.77472729\nGentoo    0.0001474703    0.006326474   0.002595476        0.02890417\n          body_mass_g\nChinstrap   0.2441534\nGentoo      0.6931102\n\nResidual Deviance: 0.00038416 \nAIC: 20.00038 \n```\n\n\n:::\n\n```{.r .cell-code}\ny_pred <- predict(model2, newdata = data_test)\nconf_table <- table(data_test$species, y_pred)\nconfusionMatrix(conf_table)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConfusion Matrix and Statistics\n\n           y_pred\n            Adelie Chinstrap Gentoo\n  Adelie        44         0      0\n  Chinstrap      1        20      0\n  Gentoo         0         0     36\n\nOverall Statistics\n                                          \n               Accuracy : 0.9901          \n                 95% CI : (0.9461, 0.9997)\n    No Information Rate : 0.4455          \n    P-Value [Acc > NIR] : < 2.2e-16       \n                                          \n                  Kappa : 0.9845          \n                                          \n Mcnemar's Test P-Value : NA              \n\nStatistics by Class:\n\n                     Class: Adelie Class: Chinstrap Class: Gentoo\nSensitivity                 0.9778           1.0000        1.0000\nSpecificity                 1.0000           0.9877        1.0000\nPos Pred Value              1.0000           0.9524        1.0000\nNeg Pred Value              0.9825           1.0000        1.0000\nPrevalence                  0.4455           0.1980        0.3564\nDetection Rate              0.4356           0.1980        0.3564\nDetection Prevalence        0.4356           0.2079        0.3564\nBalanced Accuracy           0.9889           0.9938        1.0000\n```\n\n\n:::\n\n```{.r .cell-code}\n# Misclassification\n1 - sum(diag(conf_table)) / sum(conf_table)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.00990099\n```\n\n\n:::\n:::\n\n\n\n\n\n::: {style=\"text-align: justify\"}\nThe misclassification rate of the model on test dataset is about 1% which is not bad. In fact we misclassified the species of only one penguin.\n:::\n",
    "supporting": [
      "penguins_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}